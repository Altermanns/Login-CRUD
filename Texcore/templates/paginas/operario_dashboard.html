{% extends 'paginas/base.html' %}
{% load static %}
{% block titulo %}Dashboard Operario{% endblock %}

{% block extra_css %}
<style>
.welcome-card {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
}

.quick-action {
    background: white;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    text-decoration: none;
    color: inherit;
}

.quick-action:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    text-decoration: none;
    color: inherit;
}

.quick-action svg {
    margin-bottom: 15px;
}

.stat-box {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.recent-entry {
    border-left: 4px solid #4facfe;
    background: #f8f9ff;
    padding: 15px;
    margin: 10px 0;
    border-radius: 0 8px 8px 0;
}
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Welcome Section -->
    <div class="welcome-card">
        <h2 class="mb-3">
            ¡Bienvenido, {{ user.first_name|default:user.username }}! 
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
            </svg>
        </h2>
        <p class="mb-0 opacity-90">Gestiona el ingreso de materia prima de manera eficiente</p>
    </div>

    <div class="row">
        <!-- Quick Actions -->
        <div class="col-lg-8">
            <h4 class="mb-4">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-2">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke="#4facfe" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Acciones Rápidas
            </h4>
            
            <div class="row">
                <div class="col-md-6 mb-4">
                    <a href="{% url 'crear_materia' %}" class="quick-action d-block">
                        <i class="fas fa-plus-circle fa-3x text-primary mb-3"></i>
                        <h5>Ingresar Materia Prima</h5>
                        <p class="text-muted mb-0">Registrar nuevo lote de materia prima</p>
                    </a>
                </div>
                
                <div class="col-md-6 mb-4">
                    <a href="{% url 'index_materia' %}" class="quick-action d-block">
                        <i class="fas fa-list-alt fa-3x text-primary mb-3"></i>
                        <h5>Ver Listado</h5>
                        <p class="text-muted mb-0">Consultar todos los registros</p>
                    </a>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="col-lg-4">
            <div class="stat-box text-center">
                <h5 class="text-primary mb-3">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="#4facfe" stroke-width="2" fill="none"/>
                        <line x1="16" y1="2" x2="16" y2="6" stroke="#4facfe" stroke-width="2" stroke-linecap="round"/>
                        <line x1="8" y1="2" x2="8" y2="6" stroke="#4facfe" stroke-width="2" stroke-linecap="round"/>
                        <line x1="3" y1="10" x2="21" y2="10" stroke="#4facfe" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Entradas Hoy
                </h5>
                <div class="display-4 text-primary">{{ entradas_hoy }}</div>
                <p class="text-muted mb-0">Total de registros creados hoy</p>
            </div>
        </div>
    </div>

    <!-- Recent Entries -->
    <div class="row mt-4">
        <div class="col-12">
            <h4 class="mb-4">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mr-2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke="#4facfe" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Mis Últimas Entradas
            </h4>
            
            {% for entrada in mis_entradas %}
            <div class="recent-entry">
                <div class="row align-items-center">
                    <div class="col-md-3">
                        <strong>{{ entrada.tipo|default:"Sin tipo" }}</strong>
                        <br>
                        <small class="text-muted">Lote: {{ entrada.lote }}</small>
                    </div>
                    <div class="col-md-3">
                        <span class="badge badge-primary">{{ entrada.cantidad }} {{ entrada.unidad_medida }}</span>
                    </div>
                    <div class="col-md-3">
                        {% if entrada.fecha_ingreso %}
                            {{ entrada.fecha_ingreso|date:"d/m/Y" }}
                        {% else %}
                            <span class="text-muted">Sin fecha</span>
                        {% endif %}
                    </div>
                    <div class="col-md-3 text-right">
                        <a href="{% url 'editar_materia' entrada.id %}" class="btn btn-sm btn-outline-primary">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" fill="none"/>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" fill="none"/>
                            </svg>
                            Editar
                        </a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="text-center py-5">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mb-3 opacity-50">
                    <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7z" stroke="#ddd" stroke-width="2" fill="none"/>
                </svg>
                <p class="text-muted">Aún no has registrado ninguna materia prima.</p>
                <a href="{% url 'crear_materia' %}" class="btn btn-primary">
                    ¡Crear tu primera entrada!
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}